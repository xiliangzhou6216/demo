<!--
 * @Description: 
 * @Version: 2.0
 * @Autor: xiliang
 * @Date: 2021-04-16 14:36:16
 * @LastEditors: Please set LastEditors
 * @LastEditTime: 2021-05-11 10:39:11
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    try {
      
    } catch (error) {
      
    }

/**
 * @description: 
 * @param {*}
 * @return {*}
 * @author: xiliang
 */    

    class Http{
      // get方法
      static get(url,data){
          return new Promise(( resolve,reject )=>{ 
            fetch(url+'?'+this.handleParams(data),{
              method: 'GET'
            })
            .then(response =>response.json())
            .then(res=>{
              resolve(res)
            })
            .catch(err=>{
              reject(err)
            })
          })
      }
      // post方法，data以object形式传入
      static post(url,data){
          return new Promise(( resolve,reject )=>{ 
            fetch(url,{
              // body:JSON.stringify(data),
              body:this.handleParams(data),
              method: 'POST', 
              headers:{
                // 'Content-type':'application/json;charset=UTF-8'  // JSON数据
                Accept: 'application/json',
                'Content-Type': 'application/x-www-form-urlencoded'  // 指定提交方式为表单提交
              }
            })
            .then(response =>response.json())
            .then(res=>{
              resolve(res)
            })
            .catch(err=>{
              reject(err)
            })
          })
      }
      // body请求体的格式化方法
      static handleParams(obj){
          var o=Object.keys(obj)
          var str=''
          // console.log(o)
          for(const item in o){
                str+=o[item]+'='+obj[o[item]]+(o.length-1!=item?'&':'')
          }
          return str
        }
      }
 async function Ajax() {
    const URL = "https://api.github.com/users/ruanyf"
    // 定义post入参
    const params = {foo:'bar',loop:'121'}
    const result= await  Http.get(URL,params)
    console.log(result,11111)
 }
 Ajax()

 try {
   
  
 } catch (error) {
   
 }
  </script>
  
</body>
</html>
